# 类对象占用的空间
## 1.空类
```cpp
#include <iostream>
using namespace std;

class Empty {
    // Empty class
};

int main() {
    Empty e;
    cout << "empty class size: " << sizeof(Empty) << endl;
    cout << "empty class instance size: " << sizeof(e) << endl;
    return 0;
}

empty class size: 1
empty class instance size: 1
```

可以看出空类的大小为`1`。

## 2.包含成员函数或者成员变量的类

如果在空类中增加成员函数(静态或者非静态成员函数)，可以发现，类的大小依旧是`1`。

```cpp
#include <iostream>

using namespace std;

class EmptyWithFuncMember {
public:
    void func() {}
    static void staticFunc() {}
};

int main() {
    EmptyWithFuncMember ef;
    cout << "empty class with function member size: " << sizeof(EmptyWithFuncMember) << endl;
    cout << "empty class with function member instance size: " << sizeof(ef) << endl;
    return 0;
}

empty class with function member size: 1
empty class with function member instance size: 1
```

如果在类中添加成员变量，测试如下：

```cpp
#include <iostream>

using namespace std;

class A {
public:
    char a;
};

class B {
public:
    char b;
    int c;
};

class C {
public:
    static int d;
    int e;
};

int C::d = 0;

int main() {
    A a;
    B b;
    C c1, c2;
    cout << "Size of class A: " << sizeof(a) << endl;
    cout << "Size of class B: " << sizeof(b) << endl;
    cout << "Size of class C: " << sizeof(c1) << endl;
    cout << "Size of class C: " << sizeof(c2) << endl;
    cout << "the address of c1: " << &c1.d << endl;
    cout << "the address of c2: " << &c2.d << endl;
    return 0;
}

Size of class A: 1
Size of class B: 8
Size of class C: 4
Size of class C: 4
the address of c1: 0x7ff7067c7030
the address of c2: 0x7ff7067c7030
```

我们发现类中如果包含非静态成员变量时，类的大小会根据成员变量的情况进行变化，并涉及到字节对齐的情况。如果类中包含静态成员变量，可以看出静态的成员变量与对象无关，不会包含在类的内部，而是保存在对象外部，而且多个对象共享一个该静态成员变量。

## 3. 包含虚函数的类

```cpp
#include <iostream>

using namespace std;

class A {
public:
    virtual void func() {}
};

class B {
public:
    virtual void func1() {}
    virtual void func2() {}
    int data;
};

int main() {
    A a;
    B b;
    cout << "size of A: " << sizeof(a) << endl;
    cout << "size of B: " << sizeof(b) << endl;
    return 0;
}

size of A: 8
size of B: 16
```

当类中包含一个或者多个虚函数时，对象的内存中会产生一个指向虚函数表的指针(vptr)，上述代码在64位的环境进行测试的，因此指针的大小为8，当类中还包含其他成员函数时，同样涉及内存对齐的情况。

## 4. 总结

- 空类的大小为`1`；
- 静态成员变量，成员函数(普通和静态成员函数)不计算在对象的内存中；
- 虚函数不计算在对象的内存中，但虚函数会让对象的内存增加4字节(或者8字节)以容纳指向虚函数表的指针
- 类中如果有多个成员变量，则会涉及到内存对齐的情况。